class MemoryStore { constructor() { this.store = {}; } sanitizeInput(input) { return input == null ? '' : String(input).trim(); } persist(name, data, metadata = {}) { const safeName = this.sanitizeInput(name); if (!safeName) { console.warn('Nullish/missing name provided'); return { success: false }; } const payload = { value: data, timestamp: metadata.timestamp || Date.now(), tags: metadata.tags || [] }; this.store[safeName] = payload; console.log(`Persisted ${safeName} with ${Object.keys(payload).length} fields`); return { success: true, persisted: safeName, telemetry: { type: 'persistence', name: safeName } }; } retrieve(name) { const safeName = this.sanitizeInput(name); if (!safeName || !this.store[safeName]) { return null; } return { ...this.store[safeName] }; }}
